<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Entretenimiento - Juegos Topografía</title>
   
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* estilos adicionales para selección de letras */
    .cell {
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      cursor: pointer;
    }
    .cell.selected { background-color: rgba(253, 230, 138, 0.95); }
    .cell.found { background-color: rgba(34,197,94,0.9); color: white; font-weight: 700; }
    .cell.revealed { background-color: rgba(59,130,246,0.9); color: white; font-weight: 700; }
    .input-letter { width: 40px; height: 40px; text-align:center; font-weight:700; text-transform:uppercase;}
    /* crossword grid small cells */
    .cross-cell { width:40px; height:40px; border:1px solid rgba(255,255,255,0.08); }
    .cross-cell input { width:100%; height:100%; text-align:center; font-weight:700; text-transform:uppercase; background:transparent; border:none; color:inherit;}
    .cross-black { background:rgba(0,0,0,0.7); }
  </style>
</head>
<body class="bg-green-900 text-gray-100">
  <div class="min-h-screen">
    <!-- NAV -->
    <header class="bg-green-800 shadow-lg">
      <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <img src="imagenes/logo.png" alt="Logo" class="w-12 h-12 rounded-full border-2 border-white">
          <h1 class="text-xl md:text-2xl font-extrabold text-yellow-300">Juegos Topografía</h1>
        </div>
        <nav class="space-x-4">
          <a href="#sopa" class="text-yellow-300 hover:underline">Sopa de letras</a>
          <a href="#crucigrama" class="text-yellow-300 hover:underline">Crucigrama</a>
          <a href="index.html" class="text-yellow-300 hover:underline">Inicio</a>
        </nav>
      </div>
      <p class="mt-3 text-gray-300 max-w-3xl">Diviértete y practica vocabulario topográfico. Encuentra las palabras en la sopa de letras o completa el crucigrama.</p>
    </header>

    <main class="max-w-6xl mx-auto px-4 pb-12 space-y-12">

      <!-- SOPA DE LETRAS -->
      <section id="sopa" class="bg-white/5 rounded-2xl p-6 relative overflow-hidden">
        <h2 class="text-2xl font-bold mb-4">Sopa de letras</h2>
        <p class="text-sm text-gray-300 mb-4">Selecciona letras (clic en las casillas) en orden para formar la palabra y presiona <b>Comprobar</b>. También puedes hacer clic en el primer y último para seleccionar múltiples letras.</p>

        <div class="md:flex md:gap-8">
          <!-- grid -->
          <div class="flex-1">
            <div id="grid" class="grid gap-1" style="grid-template-columns:repeat(12, 36px)"></div>
            <div class="mt-4 flex gap-3">
              <button id="checkBtn" class="bg-yellow-400 text-gray-900 px-4 py-2 rounded-lg font-semibold hover:bg-yellow-300">Comprobar</button>
              <button id="resetBtn" class="bg-white/10 px-4 py-2 rounded-lg hover:bg-white/20">Reiniciar</button>
              <button id="revealBtn" class="bg-blue-600 px-4 py-2 rounded-lg hover:bg-blue-500">Mostrar solución</button>
            </div>
            <p id="msg" class="mt-3 text-sm"></p>
          </div>

          <!-- lista de palabras -->
          <aside class="mt-6 md:mt-0 md:w-64">
            <div class="bg-white/3 rounded-lg p-4">
              <h3 class="font-semibold mb-2">Palabras a encontrar</h3>
              <ul id="wordsList" class="space-y-1 text-gray-200"></ul>
            </div>
          </aside>
        </div>
      </section>

      <!-- CRUCIGRAMA -->
      <section id="crucigrama" class="bg-white/5 rounded-2xl p-6">
        <h2 class="text-2xl font-bold mb-4">Crucigrama</h2>
        <p class="text-sm text-gray-300 mb-4">Completa el crucigrama con las palabras relacionadas a topografía. Presiona <b>Comprobar</b> o <b>Mostrar solución</b>.</p>

        <div class="md:flex md:gap-8">
          <!-- grid crucigrama -->
          <div class="bg-white/3 rounded-lg p-4">
            <div id="crossGrid" class="grid gap-0" style="grid-template-columns: repeat(9, 40px);"></div>
            <div class="mt-4 flex gap-3">
              <button id="crossCheck" class="bg-yellow-400 text-gray-900 px-4 py-2 rounded-lg font-semibold hover:bg-yellow-300">Comprobar</button>
              <button id="crossReveal" class="bg-blue-600 px-4 py-2 rounded-lg hover:bg-blue-500">Mostrar solución</button>
              <button id="crossReset" class="bg-white/10 px-4 py-2 rounded-lg hover:bg-white/20">Reiniciar</button>
            </div>
            <p id="crossMsg" class="mt-3 text-sm"></p>
          </div>

          <!-- pistas -->
          <aside class="mt-6 md:mt-0 md:flex-1">
            <div class="bg-white/3 rounded-lg p-4">
              <h3 class="font-semibold mb-2">Pistas</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <h4 class="font-semibold">Horizontal</h4>
                  <ol class="pl-4 list-decimal text-gray-200">
                    <li><b>1.</b> Instrumento para medir ángulos (9 letras)</li>
                    <li><b>3.</b> Red de elementos subterráneos para agua (9 letras)</li>
                  </ol>
                </div>
                <div>
                  <h4 class="font-semibold">Vertical</h4>
                  <ol class="pl-4 list-decimal text-gray-200">
                    <li><b>2.</b> Línea que une puntos de igual altura (5 letras)</li>
                    <li><b>4.</b> Dispositivo que proporciona posición (3 letras)</li>
                  </ol>
                </div>
              </div>
            </div>
          </aside>
        </div>
      </section>
    </main>

    <footer class="max-w-6xl mx-auto px-4 pb-10 text-sm text-gray-400">
      <p>© <span id="y"></span> Juegos Topografía. Practica y diviértete.</p>
    </footer>
  </div>

  <!-- LOGICA JS -->
  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    /* ---------- SOPA DE LETRAS ---------- */
    // palabras (ES) relacionadas con topografía
    const WORDS = ['ESTACION', 'CURVA', 'ALCANTARILLADO', 'DRONE', 'GPS', 'COORDENADA', 'NIVEL', 'PROFUNDIDAD'];

    // grid 12x12
    const ROWS = 12, COLS = 12;
    let grid = Array.from({length: ROWS}, () => Array.from({length: COLS}, () => ''));

    const placed = [];

    function placeWord(word) {
      const maxAttempts = 200;
      const len = word.length;
      for (let attempt=0; attempt<maxAttempts; attempt++) {
        const dir = Math.random() < 0.5 ? 'H' : 'V';
        let r = Math.floor(Math.random()*ROWS);
        let c = Math.floor(Math.random()*COLS);
        if (dir === 'H') {
          if (c + len > COLS) continue;
          let ok = true;
          for (let i=0;i<len;i++) {
            const ch = grid[r][c+i];
            if (ch !== '' && ch !== word[i]) { ok = false; break; }
          }
          if (!ok) continue;
          const coords = [];
          for (let i=0;i<len;i++) { grid[r][c+i] = word[i]; coords.push({r,c:c+i}); }
          return coords;
        } else {
          if (r + len > ROWS) continue;
          let ok = true;
          for (let i=0;i<len;i++) {
            const ch = grid[r+i][c];
            if (ch !== '' && ch !== word[i]) { ok=false; break; }
          }
          if (!ok) continue;
          const coords = [];
          for (let i=0;i<len;i++) { grid[r+i][c] = word[i]; coords.push({r:r+i,c}); }
          return coords;
        }
      }
      return null;
    }

    function fillGridRandom() {
      const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      for(let r=0;r<ROWS;r++) {
        for(let c=0;c<COLS;c++) {
          if(grid[r][c]==='') {
            grid[r][c] = letters.charAt(Math.floor(Math.random()*letters.length));
          }
        }
      }
    }

    function createGrid() {
      const gridEl = document.getElementById('grid');
      gridEl.style.gridTemplateColumns = `repeat(${COLS},36px)`;
      gridEl.innerHTML = '';

      for(let r=0;r<ROWS;r++) {
        for(let c=0;c<COLS;c++) {
          const cell = document.createElement('div');
          cell.className = 'cell bg-green-800 text-yellow-300 font-bold text-lg flex items-center justify-center select-none';
          cell.dataset.r = r;
          cell.dataset.c = c;
          cell.textContent = grid[r][c];
          cell.addEventListener('click', onCellClick);
          gridEl.appendChild(cell);
        }
      }
    }

    // colocar palabras en la sopa
    WORDS.forEach(w => {
      const coords = placeWord(w);
      if(coords) placed.push({word:w, coords});
    });
    fillGridRandom();
    createGrid();

    // lista de palabras
    const wordsListEl = document.getElementById('wordsList');
    WORDS.forEach(w => {
      const li = document.createElement('li');
      li.textContent = w;
      li.className = 'line-through decoration-transparent';
      wordsListEl.appendChild(li);
    });

    // seleccion letras
    let selectedCells = [];
    let selecting = false;

    function onCellClick(e) {
      const cell = e.currentTarget;
      if(selectedCells.length > 0 && selectedCells.some(c=>c===cell)) {
        // si clickeo en último seleccionado, deseleccionar
        if(cell === selectedCells[selectedCells.length-1]) {
          cell.classList.remove('selected');
          selectedCells.pop();
        }
        return;
      }
      cell.classList.add('selected');
      selectedCells.push(cell);
    }

    function resetSelection() {
      selectedCells.forEach(c => c.classList.remove('selected'));
      selectedCells = [];
    }

    document.getElementById('checkBtn').addEventListener('click', () => {
      if(selectedCells.length === 0) return;
      const word = selectedCells.map(c => c.textContent).join('');
      let foundIndex = -1;
      for(let i=0;i<placed.length;i++) {
        if(placed[i].word === word) {
          // comparar con coords seleccionadas
          const selCoords = selectedCells.map(c => ({r: parseInt(c.dataset.r), c:parseInt(c.dataset.c)}));
          let match = true;
          const pCoords = placed[i].coords;
          if(selCoords.length !== pCoords.length) match = false;
          else {
            for(let j=0;j<selCoords.length;j++) {
              if(selCoords[j].r !== pCoords[j].r || selCoords[j].c !== pCoords[j].c) {
                match = false; break;
              }
            }
          }
          if(match) {
            foundIndex = i; break;
          }
        }
      }
      const msg = document.getElementById('msg');
      if(foundIndex >=0) {
        msg.textContent = `¡Correcto! Encontraste "${placed[foundIndex].word}"`;
        msg.className = "text-green-400 font-semibold";
        // marcar casillas en verde y palabra tachada
        placed[foundIndex].coords.forEach(({r,c}) => {
          const cell = document.querySelector(`#grid > div[data-r="${r}"][data-c="${c}"]`);
          cell.classList.add('found');
        });
        wordsListEl.children[foundIndex].classList.add('line-through');
        resetSelection();
      } else {
        msg.textContent = 'Palabra incorrecta o no encontrada.';
        msg.className = "text-red-500 font-semibold";
      }
    });

    document.getElementById('resetBtn').addEventListener('click', () => {
      resetSelection();
      document.getElementById('msg').textContent = '';
    });

    document.getElementById('revealBtn').addEventListener('click', () => {
      placed.forEach(({coords}) => {
        coords.forEach(({r,c}) => {
          const cell = document.querySelector(`#grid > div[data-r="${r}"][data-c="${c}"]`);
          cell.classList.add('found');
        });
      });
      for(let i=0;i<wordsListEl.children.length;i++) {
        wordsListEl.children[i].classList.add('line-through');
      }
      document.getElementById('msg').textContent = 'Solución mostrada.';
      document.getElementById('msg').className = "text-blue-400 font-semibold";
      resetSelection();
    });

    /* ---------- CRUCIGRAMA ---------- */
    /*
    Nuevo crucigrama:
    9x9
    Palabras:
    1 HORIZONTAL (9) - TEODOLITO
    2 VERTICAL (5) - CURVA
    3 HORIZONTAL (9) - ALCANTARIL
    4 VERTICAL (3) - GPS
    */

    const crossWords = [
      {num:1, direction:'H', row:0, col:0, word:'TEODOLITO'},
      {num:2, direction:'V', row:0, col:4, word:'CURVA'},
      {num:3, direction:'H', row:5, col:0, word:'ALCANTARIL'}, // cambié ALCANTARILLADO por ALCANTARIL para 9 letras
      {num:4, direction:'V', row:0, col:8, word:'GPS'},
    ];

    const CROSS_ROWS = 9;
    const CROSS_COLS = 9;

    function createCrosswordGrid() {
      const crossGridEl = document.getElementById('crossGrid');
      crossGridEl.style.gridTemplateColumns = `repeat(${CROSS_COLS}, 40px)`;
      crossGridEl.innerHTML = '';

      for(let r=0;r<CROSS_ROWS;r++) {
        for(let c=0;c<CROSS_COLS;c++) {
          const cell = document.createElement('div');
          cell.classList.add('cross-cell');
          // comprobar si celda está negra o blanca
          let isBlack = true;
          for(const w of crossWords) {
            if(w.direction === 'H') {
              if(r === w.row && c >= w.col && c < w.col + w.word.length) {
                isBlack = false;
                break;
              }
            } else {
              if(c === w.col && r >= w.row && r < w.row + w.word.length) {
                isBlack = false;
                break;
              }
            }
          }
          if(isBlack) cell.classList.add('cross-black');

          if(!isBlack) {
            // input para letra
            const input = document.createElement('input');
            input.type = 'text';
            input.maxLength = 1;
            input.className = 'input-letter bg-transparent text-gray-900 dark:text-gray-100';
            input.autocomplete = 'off';
            input.dataset.r = r;
            input.dataset.c = c;
            input.style.textTransform = 'uppercase';
            cell.appendChild(input);

            // número pista (solo si está al inicio de palabra)
            for(const w of crossWords) {
              if(w.direction === 'H' && r === w.row && c === w.col) {
                const numSpan = document.createElement('span');
                numSpan.textContent = w.num;
                numSpan.style.position = 'absolute';
                numSpan.style.fontSize = '0.6rem';
                numSpan.style.color = '#b45309';
                numSpan.style.top = '2px';
                numSpan.style.left = '2px';
                numSpan.style.fontWeight = '700';
                cell.style.position = 'relative';
                cell.appendChild(numSpan);
              }
              if(w.direction === 'V' && c === w.col && r === w.row) {
                const numSpan = document.createElement('span');
                numSpan.textContent = w.num;
                numSpan.style.position = 'absolute';
                numSpan.style.fontSize = '0.6rem';
                numSpan.style.color = '#b45309';
                numSpan.style.top = '2px';
                numSpan.style.left = '2px';
                numSpan.style.fontWeight = '700';
                cell.style.position = 'relative';
                cell.appendChild(numSpan);
              }
            }
          }
          crossGridEl.appendChild(cell);
        }
      }
    }
    createCrosswordGrid();

    // botones crucigrama
    document.getElementById('crossCheck').addEventListener('click', () => {
      const crossMsg = document.getElementById('crossMsg');
      let allCorrect = true;
      for(const w of crossWords) {
        for(let i=0;i<w.word.length;i++) {
          let r = w.row;
          let c = w.col;
          if(w.direction === 'H') c += i;
          else r += i;
          const input = document.querySelector(`#crossGrid input[data-r="${r}"][data-c="${c}"]`);
          if(!input) continue;
          if(input.value.toUpperCase() !== w.word[i]) {
            allCorrect = false;
            input.classList.add('border-red-500');
          } else {
            input.classList.remove('border-red-500');
          }
        }
      }
      if(allCorrect) {
        crossMsg.textContent = "¡Correcto! Has completado el crucigrama.";
        crossMsg.className = "text-green-400 font-semibold";
      } else {
        crossMsg.textContent = "Hay errores en las respuestas.";
        crossMsg.className = "text-red-500 font-semibold";
      }
    });

    document.getElementById('crossReveal').addEventListener('click', () => {
      for(const w of crossWords) {
        for(let i=0;i<w.word.length;i++) {
          let r = w.row;
          let c = w.col;
          if(w.direction === 'H') c += i;
          else r += i;
          const input = document.querySelector(`#crossGrid input[data-r="${r}"][data-c="${c}"]`);
          if(!input) continue;
          input.value = w.word[i];
          input.classList.remove('border-red-500');
          input.classList.add('bg-blue-400', 'text-white');
        }
      }
      const crossMsg = document.getElementById('crossMsg');
      crossMsg.textContent = "Solución mostrada.";
      crossMsg.className = "text-blue-400 font-semibold";
    });

    document.getElementById('crossReset').addEventListener('click', () => {
      const inputs = document.querySelectorAll('#crossGrid input');
      inputs.forEach(input => {
        input.value = '';
        input.classList.remove('border-red-500','bg-blue-400','text-white');
      });
      const crossMsg = document.getElementById('crossMsg');
      crossMsg.textContent = '';
    });
  </script>
</body>
</html>
